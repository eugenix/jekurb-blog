---
title: "–°–æ–∑–¥–∞–µ–º —Ç–µ—Ö–±–ª–æ–≥ –∑–∞ –≤–µ—á–µ—Ä —Å CD pipeline –∏ –±–ª—ç–∫–¥–∂–µ–∫–æ–º"
date: 2020-07-23T22:47:00+03:00
draft: false
tags: [github, blog]
---

![image alt text](images/tech-blog.png)

–í—á–µ—Ä–∞ –≤–µ—á–µ—Ä–æ–º ~~–≤ –æ—á–µ—Ä–µ–¥–Ω–æ–π —Ä–∞–∑~~ –ø–æ–Ω—è–ª, —á—Ç–æ —Ö–æ—á—É –∑–∞–≤–µ—Å—Ç–∏ —Å–≤–æ–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –±–ª–æ–≥. –í –ø—Ä–æ—à–ª–æ–º —É–∂–µ –±—ã–ª–∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏,
 –∫–æ–≥–¥–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ —ç—Ç–æ–π –∑–∞—Ç–µ–µ —Ç–µ—Ä—è–ª—Å—è. –ù–æ –º—ã –∂–µ –æ–ø—Ç–∏–º–∏—Å—Ç—ã - –∏ –≤ —ç—Ç–æ—Ç –≤ —Ä–∞–∑ –≤—Å–µ –±—É–¥–µ—Ç –ø–æ-–¥—Ä—É–≥–æ–º—É! üí™ –î–∞–±—ã –Ω–µ —Ä–∞—Å—Ç–µ—Ä—è—Ç—å
 –∑–∞–ø–∞–ª —Ä–µ—à–∏–ª –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–π —à–∞–≥ - –∑–∞—Ä–µ–ª–∏–∑–∏—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –±–ª–æ–≥–∞.

–ò—Ç–∞–∫, –Ω–∞—á–Ω–µ–º —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:

- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ–≥–æ –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π, –º–æ–∂–Ω–æ —ç—Ç–æ –Ω–∞–∑–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥–æ–º - Blog as Code
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–∏–Ω–≥–∞
- –ü—Ä–æ—Å—Ç–æ–µ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è
- CD pipeline —Å–æ smoke-—Ç–µ—Å—Ç–∞–º–∏ –∏ –≤—ã–∫–ª–∞–¥–∫–æ–π –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥ –ø–æ –∫–æ–º–º–∏—Ç—É

–î—É–º–∞—é, –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –±–ª–æ–≥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ —Å–∞–º–æ–µ –æ–Ω–æ üòâ

### –ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–î–ª—è —ç—Ç–æ–≥–æ —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –¥–æ–±—Ä—ã–π markdown –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–≥–æ. –ü–µ—Ä–µ—á–∏—Å–ª—é –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã:

- [Jekyll](http://jekyllrb.com)
- [Hugo](https://gohugo.io/)
- [Gatsby](https://gatsby.js),  [Next.js](https://next.js) - –Ω–æ–≤–æ–º–æ–¥–Ω—ã–µ –Ω–∞ React

–í –∏—Ç–æ–≥–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±–µ–≥–ª–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–π –≤—ã–±–æ—Ä –ø–∞–ª –Ω–∞ Hugo, –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –º–Ω–æ–≥–æ –∑–≤–µ–∑–¥ –Ω–∞ github,
 –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–∞–∫ –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Go (–∫–∞–∫ –∑–∞—è–≤–ª—è–µ—Ç –∞–≤—Ç–æ—Ä < 1 ms per page).

–°–ª–µ–¥—É—è [Quick start guide](https://gohugo.io/getting-started/quick-start/) –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤—É –±–ª–æ–≥–∞ –∏ –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.

```bash
brew install hugo
hugo new site jekurb
hugo new posts/blog-kick-off/index.md
hugo server -D
```

### –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–∫—É—Å –±–ª–æ–≥–∞ –±—É–¥–µ—Ç –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–µ, –ø–æ—ç—Ç–æ–º—É –≤ –¥–∏–∑–∞–π–Ω–µ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ.
–£ Hugo –µ—Å—Ç—å [–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://themes.gohugo.io/) —Å —Ç–µ–º–∞–º–∏. –ú–æ–π —Ç–æ–ø-3 —Ç–µ–º –¥–ª—è –±–ª–æ–≥–∞:

1. [Hugo Ink](https://themes.gohugo.io/hugo-ink/)
2. [Hugo Vitae](https://themes.gohugo.io/hugo-vitae/)
3. [LoveIt](https://themes.gohugo.io/LoveIt/)

–° –±–æ–ª—å—à–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ —Ç–µ–º–µ –≤ –±—É–¥—É—â–µ–º –±—É–¥—É—Ç –∫–∞–∫–∏–µ-—Ç–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∫–∏, –ø–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –∫–ª–∞—Å—Ç—å –≤ _/themes_ –µ–µ
–∫–∞–∫ –Ω–µ –∫–∞–∫ git module. –î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ç–µ–º—ã –≤ _config.toml_ –¥–æ–±–∞–≤–ª—è–µ–º:

```toml
theme = "hugo-ink"
```  

### Blog as Code

–í –º–æ–µ–º —Å–ª—É—á–∞–µ –≤—Å–µ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏](https://github.com/eugenix/jekurb-blog) –Ω–∞ github.
–ù–µ –∑–∞–±—ã–≤–∞–µ–º –¥–æ–±–∞–≤–∏—Ç—å –≤ .gitignore –≤—Å–µ, —Ç–æ —á—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ç—Å—è Hugo.

```gitignore
public
.idea
resources/_gen
```

–ù–µ–º–Ω–æ–≥–æ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π Hugo

```text
.
‚îú‚îÄ‚îÄ archetypes   | –∞—Ä—Ö–µ—Ç–∏–ø—ã, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –±–ª–æ–≥ –ø–æ—Å—Ç—ã —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã hugo new
‚îú‚îÄ‚îÄ config.toml  | –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ content      | –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –≤–∏–¥–µ md —Ñ–∞–π–ª–æ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–Ω–æ–π
‚îú‚îÄ‚îÄ data         | –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ layouts      | —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü
‚îú‚îÄ‚îÄ public       | —Å–±–æ—Ä–∫–∞ —Å–∞–π—Ç–∞
‚îú‚îÄ‚îÄ resources    | –∫—ç—à
‚îú‚îÄ‚îÄ static       | —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã, –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ themes       | —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ–º—ã
```

### –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–∏–Ω–≥–∞

–î–∞–≤–Ω–æ –∏–∑–≤–µ—Å—Ç–Ω–æ, —É github –µ—Å—Ç—å –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–∏—á–∞ [Gihub pages](https://pages.github.com/), –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö–æ—Å—Ç–∏—Ç—å
—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ò –¥–∞, —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.
–ü–æ—ç—Ç–æ–º—É –∑–∞–≤–µ–¥–µ–º [–≤—Ç–æ—Ä–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/eugenix/eugenix.github.io) –¥–ª—è "—Ä–µ–ª–∏–∑–Ω–æ–≥–æ –±–∏–ª–¥–∞" –±–ª–æ–≥–∞.

### –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è

–ü–æ—Å–ª–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑–¥—É–º–∏–π, –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è **jekurb.dev** –∏ —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–∞ reg.ru.
–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —ç—Ç–æ–π –∑–æ–Ω–µ - 1392 RUB –∑–∞ –≥–æ–¥.
–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—É–¥–µ—Ç custom domains –≤
[Github pages](https://docs.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site),
 –¥–ª—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
![image custom domain](images/custom-domain.png)
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª—è Custom domain - —Å–æ–∑–¥–∞–Ω–∏–µ CNAME –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
–î–∞–ª–µ–µ –∏–¥–µ–º –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –∏ –Ω–∞—Å—Ç–∞–∏–≤–∞–µ–º DNS –∑–∞–ø–∏—Å–∏, –Ω–∞—Å—Ç—Ä–æ–∏–º CNAME –¥–ª—è —Å–∞–±–¥–æ–º–µ–Ω–∞ www, —É–∫–∞–∑—ã–≤–∞—é—â—É—é –Ω–∞ eugenix.github.io
–∏ A records –¥–ª—è amex –¥–æ–º–µ–Ω–∞.
![image dns](images/dns.png)
–ü—Ä–∏–º–µ—Ä–Ω–æ —á–µ—Ä–µ–∑ 4 —á–∞—Å–∞ DNS –æ–±–Ω–æ–≤–∏–ª—Å—è –∏ –±–ª–æ–≥ —Å—Ç–∞–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –¥–æ–º–µ–Ω—É. –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –ø—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—Å—Ç–∞–ª–æ:

```bash
dig www.jekurb.dev +nostats +nocomments +nocmd

; <<>> DiG 9.10.6 <<>> www.jekurb.dev +nostats +nocomments +nocmd
;; global options: +cmd
;www.jekurb.dev.			IN	A
www.jekurb.dev.		21599	IN	CNAME	eugenix.github.io.
eugenix.github.io.	3599	IN	A	185.199.109.153
eugenix.github.io.	3599	IN	A	185.199.108.153
eugenix.github.io.	3599	IN	A	185.199.111.153
eugenix.github.io.	3599	IN	A	185.199.110.153
```

```bash
dig jekurb.dev +noall +answer

; <<>> DiG 9.10.6 <<>> jekurb.dev +noall +answer
;; global options: +cmd
jekurb.dev.		21599	IN	A	185.199.108.153
jekurb.dev.		21599	IN	A	185.199.109.153
jekurb.dev.		21599	IN	A	185.199.110.153
jekurb.dev.		21599	IN	A	185.199.111.153
```

### CD pipeline

- md lint
- e2e test

```yaml
name: Deploy to GitHub Pages on push to master
on:
  push:
    branches:
      - master
jobs:
  build:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout master
        uses: actions/checkout@v1

      - name: Setup node
        uses: actions/setup-node@v1
        with:
          node-version: '12.x'

      - name: Check markdown
      - run: npm install -g markdownlint-cli
      - run: markdownlint content

      - name: Deploy the site
        uses: benmatselby/hugo-deploy-gh-pages@master
        env:
          HUGO_VERSION: 0.74.2
          TARGET_REPO: eugenix/eugenix.github.io
          TOKEN: ${{ secrets.PERSONAL_TOKEN }}
          HUGO_ARGS: ''
          CNAME: jekurb.dev

      - name: Run smoke tests
        env:
          BLOG_BASE_URL: https://jekurb.dev
        run: cd smoke-tests && npm install && npm test
```

### –í—ã–≤–æ–¥—ã

–í–æ-–ø–µ—Ä–≤—ã—Ö, —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ 99% –≤—Å–µ–≥–æ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å, –Ω–∞—á–∏–Ω–∞—è –¥–≤–∏–∂–∫–æ–º –¥–ª—è –±–ª–æ–≥–∞ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
 –¥–ª—è pipeline –∏ —Ö–æ—Å—Ç–∏–Ω–≥–æ–º –µ—Å—Ç—å –Ω–∞ github.
–í–æ-–≤—Ç–æ—Ä—ã—Ö, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è –æ–∫–∞–∑–∞–ª—Å—è –¥–æ–≤–æ–ª–µ–Ω –∏ —Å–º–æ–≥ –¥–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –ø–æ–¥–Ω—è—Ç—å —Å–≤–æ–π –±–ª–æ–≥ —Å CD pipeline'–æ–º –∏ –±–ª—ç–∫–¥–∂–µ–∫–æ–º –Ω–µ
–∏–º–µ—è –æ—Å–æ–±–æ–≥–æ –æ–ø—ã—Ç–∞ –≤ "–±–ª–æ–≥–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏" –º–æ–∂–Ω–æ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤. –ì–ª–∞–≤–Ω–æ–µ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–π —à–∞–≥, –∞ –¥–∞–ª—å—à–µ –ø—Ä–æ—Ü–µ—Å—Å –≤–∞—Å –∑–∞—Ç—è–Ω–µ—Ç.
